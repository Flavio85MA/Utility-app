<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>PDF & Image Toolkit</title>
  <!-- Mantengo il nome come nel tuo progetto: "Style.css" -->
  <link rel="stylesheet" href="Style.css"/>

  <!-- Librerie core PDF -->
  <script src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

  <!-- DOCX / WORD->PDF -->
  <script src="https://cdn.jsdelivr.net/npm/docx@8.5.0/build/index.umd.js"></script>
  <script src="https://unpkg.com/mammoth/mammoth.browser.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

  <!-- Excel in browser -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

  <!-- Immagini: resize di qualità -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pica/9.0.1/pica.min.js"></script>
</head>
<body>
  <header class="app-header">
    <h1>PDF · Immagini Toolkit</h1>
    <button id="open-settings" class="btn ghost" type="button">Impostazioni</button>
  </header>

  <nav class="tabs">
    <button id="btn-pdf" class="tab active" type="button">Strumenti PDF</button>
    <button id="btn-images" class="tab" type="button">Strumenti immagini</button>
  </nav>

  <main class="container">
    <!-- ===================== SEZIONE PDF ===================== -->
    <section id="section-pdf" class="section active">
      <div class="card">
        <h3>Strumenti PDF</h3>

        <div class="grid two">
          <!-- DIVIDI PDF -->
          <div class="card soft">
            <h4>Dividi PDF (estrai pagine selezionate)</h4>
            <input type="file" id="split-file" accept="application/pdf">
            <div class="row">
              <button id="split-select-all" class="btn">Seleziona tutto</button>
              <button id="split-clear-sel" class="btn warn">Pulisci selezione</button>
              <span class="hint">Clicca sulle anteprime per selezionare/deselezionare.</span>
            </div>
            <div id="split-preview" class="thumbs"></div>
            <button id="split-run" class="btn primary">Crea PDF con pagine selezionate</button>
            <div class="status" id="split-status"></div>
          </div>

          <!-- ELIMINA PAGINE -->
          <div class="card soft">
            <h4>Eliminatore di pagine PDF (rimuovi selezionate)</h4>
            <input type="file" id="delete-file" accept="application/pdf">
            <div class="row">
              <button id="delete-select-all" class="btn">Seleziona tutto</button>
              <button id="delete-clear-sel" class="btn warn">Pulisci selezione</button>
              <span class="hint">Clicca sulle anteprime per selezionare/deselezionare.</span>
            </div>
            <div id="delete-preview" class="thumbs"></div>
            <button id="delete-run" class="btn primary">Crea PDF senza pagine selezionate</button>
            <div class="status" id="delete-status"></div>
          </div>
        </div>

        <div class="grid two">
          <!-- PDF → IMMAGINI -->
          <div class="card soft">
            <h4>PDF → Immagini</h4>
            <input type="file" id="pdf-input" accept="application/pdf">
            <label>Formato:
              <select id="pdf2img-format">
                <option value="png" selected>PNG</option>
                <option value="jpeg">JPEG</option>
              </select>
            </label>
            <button id="pdf2img-run" class="btn">Converti</button>
            <div id="pdf2img-status" class="status"></div>
            <div id="pdf2img-preview" class="thumbs"></div>
            <div class="row">
              <button id="pdf2img-download-all" class="btn" disabled>Scarica tutte</button>
              <button id="pdf2img-clear" class="btn warn">Pulisci</button>
            </div>
          </div>

          <!-- IMMAGINI → PDF -->
          <div class="card soft">
            <h4>Immagini → PDF</h4>
            <input type="file" id="img2pdf-input" accept="image/*" multiple>
            <label>Orientamento:
              <select id="pdf-orientation">
                <option value="auto" selected>Auto</option>
                <option value="p">Portrait</option>
                <option value="l">Landscape</option>
              </select>
            </label>
            <label class="checkbox">
              <input type="checkbox" id="fit-page" checked> Adatta pagina
            </label>
            <button id="img2pdf-run" class="btn">Crea PDF</button>
            <div id="img2pdf-status" class="status"></div>
          </div>
        </div>

        <!-- CONVERSIONI: solo Word→PDF e Excel→PDF -->
        <div class="card soft">
          <h4>Conversioni</h4>

          <div class="row">
            <input type="file" id="word-file" accept=".doc,.docx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document">
            <button id="word2pdf-run" class="btn">da WORD a PDF</button>
            <button id="word2pdf-dl" class="btn mini" disabled>Scarica</button>
          </div>

          <div class="row">
            <input type="file" id="excel-file" accept=".xlsx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet">
            <button id="excel2pdf-run" class="btn">da EXCEL a PDF</button>
            <button id="excel2pdf-dl" class="btn mini" disabled>Scarica</button>
          </div>

          <div class="status" id="advconv-status"></div>
        </div>
      </div>
    </section>

    <!-- ===================== SEZIONE IMMAGINI ===================== -->
    <section id="section-images" class="section">
      <div class="card">
        <h3>Strumenti Immagini</h3>

        <div class="grid two">
          <!-- Comprimi -->
          <div class="card soft">
            <h4>Comprimi immagine</h4>
            <input type="file" id="cmp-file" accept="image/*">
            <div class="row">
              <label>Qualità:
                <input type="range" id="cmp-quality" min="0.1" max="1" step="0.05" value="0.8">
                <span id="cmp-quality-val" class="muted">80%</span>
              </label>
            </div>
            <button id="cmp-run" class="btn">Comprimi</button>
            <button id="cmp-dl" class="btn mini" disabled>Scarica</button>
            <div id="cmp-status" class="status"></div>
            <div id="cmp-preview" class="thumbs"></div>
          </div>

          <!-- Ridimensiona -->
          <div class="card soft">
            <h4>Ridimensiona</h4>
            <input type="file" id="rsz-file" accept="image/*">
            <div class="row">
              <label>Larghezza (px): <input type="number" id="rsz-w" min="1" value="1080"></label>
              <label>Altezza (px): <input type="number" id="rsz-h" min="1" value="1080"></label>
              <label class="checkbox"><input type="checkbox" id="rsz-keep" checked> Mantieni proporzioni</label>
            </div>
            <button id="rsz-run" class="btn">Ridimensiona</button>
            <button id="rsz-dl" class="btn mini" disabled>Scarica</button>
            <div id="rsz-status" class="status"></div>
            <div id="rsz-preview" class="thumbs"></div>
          </div>
        </div>

        <!-- Cambia formato (aspect ratio) -->
        <div class="card soft">
          <h4>Cambia formato (aspect ratio)</h4>

          <input type="file" id="ar-file" accept="image/*">

          <div class="row">
            <label>Rapporto:
              <select id="ar-ratio">
                <option value="1:1" selected>1:1 (quadrato)</option>
                <option value="4:5">4:5 (post IG)</option>
                <option value="16:9">16:9 (orizzontale)</option>
                <option value="9:16">9:16 (verticale)</option>
              </select>
            </label>
            <label>Modalità:
              <select id="ar-mode">
                <option value="crop" selected>Crop (ritaglia)</option>
                <option value="pad">Pad (riempi bordi)</option>
              </select>
            </label>
            <label>Colore bordi:
              <input type="color" id="ar-bg" value="#000000">
            </label>
          </div>

          <div id="ar-preview" class="thumbs"></div>

          <div class="row">
            <button id="ar-run" class="btn">Applica</button>
            <button id="ar-dl" class="btn mini" disabled>Scarica</button>
          </div>

          <div id="ar-status" class="status"></div>
          <div class="canvas-wrap"><canvas id="ar-canvas"></canvas></div>
        </div>

        <div class="grid two">
          <!-- Combina immagini -->
          <div class="card soft">
            <h4>Combina immagini (max 2)</h4>

            <div id="cmb-drop" class="dropzone">
              <strong>Trascina qui fino a 2 immagini</strong><br>
              oppure
              <label class="btn">Scegli file
                <input type="file" id="cmb-files" accept="image/*" multiple>
              </label>
            </div>

            <div class="row">
              <label>Layout:
                <select id="cmb-layout">
                  <option value="horizontal">Orizzontale</option>
                  <option value="vertical">Verticale</option>
                </select>
              </label>
              <label>Spaziatura (px): <input type="number" id="cmb-gap" min="0" value="8"></label>
              <label>Colore sfondo: <input type="color" id="cmb-bg" value="#ffffff"></label>
            </div>

            <div id="cmb-preview" class="thumbs"></div>

            <button id="cmb-run" class="btn">Combina</button>
            <button id="cmb-dl" class="btn mini" disabled>Scarica</button>
            <div id="cmb-status" class="status"></div>
            <div class="canvas-wrap"><canvas id="cmb-canvas"></canvas></div>
          </div>

          <!-- Creatore di collage -->
          <div class="card soft">
            <h4>Creatore di collage</h4>

            <div id="clg-drop" class="dropzone">
              <strong>Trascina qui le immagini</strong><br>
              oppure
              <label class="btn">Scegli file
                <input type="file" id="clg-files" accept="image/*" multiple>
              </label>
            </div>

            <div class="row">
              <label>Righe: <input type="number" id="clg-rows" min="1" value="2"></label>
              <label>Colonne: <input type="number" id="clg-cols" min="1" value="2"></label>
              <label>Gap (px): <input type="number" id="clg-gap" min="0" value="8"></label>
              <label>Canvas (px): <input type="number" id="clg-w" min="100" value="1080">×<input type="number" id="clg-h" min="100" value="1080"></label>
              <label>Background: <input type="color" id="clg-bg" value="#ffffff"></label>
              <label>Fit:
                <select id="clg-fit">
                  <option value="cover" selected>Cover (riempi)</option>
                  <option value="contain">Contain (adatta)</option>
                </select>
              </label>
            </div>

            <div id="clg-preview" class="thumbs"></div>

            <button id="clg-run" class="btn">Crea Collage</button>
            <button id="clg-dl" class="btn mini" disabled>Scarica</button>
            <div id="clg-status" class="status"></div>
            <div class="canvas-wrap"><canvas id="clg-canvas"></canvas></div>
          </div>
        </div>

        <!-- Conversioni formato (layout a due pannelli) -->
        <div class="card soft">
          <h4>Conversioni formato</h4>

          <div class="tiles duo">
            <!-- PNG → JPG -->
            <div class="tile">
              <h5>PNG → JPG</h5>
              <div class="tile-grid two">
                <div class="pane">
                  <label class="btn">Scegli PNG
                    <input type="file" accept="image/png" data-from="image/png" data-to="image/jpeg">
                  </label>
                  <div class="preview-box">
                    <div class="preview-title">Anteprima originale</div>
                    <div class="preview-body"><img data-input-preview alt=""></div>
                  </div>
                </div>
                <div class="pane">
                  <div class="row">
                    <button class="btn" data-convert>Converti</button>
                    <button class="btn mini" data-download disabled>Scarica</button>
                  </div>
                  <div class="status" data-status></div>
                  <div class="preview-box">
                    <div class="preview-title">Risultato</div>
                    <div class="preview-body"><img data-output-preview alt=""></div>
                  </div>
                </div>
              </div>
            </div>

            <!-- JPG → PNG -->
            <div class="tile">
              <h5>JPG → PNG</h5>
              <div class="tile-grid two">
                <div class="pane">
                  <label class="btn">Scegli JPG/JPEG
                    <input type="file" accept="image/jpeg" data-from="image/jpeg" data-to="image/png">
                  </label>
                  <div class="preview-box">
                    <div class="preview-title">Anteprima originale</div>
                    <div class="preview-body"><img data-input-preview alt=""></div>
                  </div>
                </div>
                <div class="pane">
                  <div class="row">
                    <button class="btn" data-convert>Converti</button>
                    <button class="btn mini" data-download disabled>Scarica</button>
                  </div>
                  <div class="status" data-status></div>
                  <div class="preview-box">
                    <div class="preview-title">Risultato</div>
                    <div class="preview-body"><img data-output-preview alt=""></div>
                  </div>
                </div>
              </div>
            </div>

            <!-- PNG → WEBP -->
            <div class="tile">
              <h5>PNG → WEBP</h5>
              <div class="tile-grid two">
                <div class="pane">
                  <label class="btn">Scegli PNG
                    <input type="file" accept="image/png" data-from="image/png" data-to="image/webp">
                  </label>
                  <div class="preview-box">
                    <div class="preview-title">Anteprima originale</div>
                    <div class="preview-body"><img data-input-preview alt=""></div>
                  </div>
                </div>
                <div class="pane">
                  <div class="row">
                    <button class="btn" data-convert>Converti</button>
                    <button class="btn mini" data-download disabled>Scarica</button>
                  </div>
                  <div class="status" data-status></div>
                  <div class="preview-box">
                    <div class="preview-title">Risultato</div>
                    <div class="preview-body"><img data-output-preview alt=""></div>
                  </div>
                </div>
              </div>
            </div>

            <!-- JPG → WEBP -->
            <div class="tile">
              <h5>JPG → WEBP</h5>
              <div class="tile-grid two">
                <div class="pane">
                  <label class="btn">Scegli JPG/JPEG
                    <input type="file" accept="image/jpeg" data-from="image/jpeg" data-to="image/webp">
                  </label>
                  <div class="preview-box">
                    <div class="preview-title">Anteprima originale</div>
                    <div class="preview-body"><img data-input-preview alt=""></div>
                  </div>
                </div>
                <div class="pane">
                  <div class="row">
                    <button class="btn" data-convert>Converti</button>
                    <button class="btn mini" data-download disabled>Scarica</button>
                  </div>
                  <div class="status" data-status></div>
                  <div class="preview-box">
                    <div class="preview-title">Risultato</div>
                    <div class="preview-body"><img data-output-preview alt=""></div>
                  </div>
                </div>
              </div>
            </div>

            <!-- WEBP → PNG -->
            <div class="tile">
              <h5>WEBP → PNG</h5>
              <div class="tile-grid two">
                <div class="pane">
                  <label class="btn">Scegli WEBP
                    <input type="file" accept="image/webp" data-from="image/webp" data-to="image/png">
                  </label>
                  <div class="preview-box">
                    <div class="preview-title">Anteprima originale</div>
                    <div class="preview-body"><img data-input-preview alt=""></div>
                  </div>
                </div>
                <div class="pane">
                  <div class="row">
                    <button class="btn" data-convert>Converti</button>
                    <button class="btn mini" data-download disabled>Scarica</button>
                  </div>
                  <div class="status" data-status></div>
                  <div class="preview-box">
                    <div class="preview-title">Risultato</div>
                    <div class="preview-body"><img data-output-preview alt=""></div>
                  </div>
                </div>
              </div>
            </div>

          </div><!-- /tiles -->
        </div>
      </div>
    </section>
  </main>

  <dialog id="settings-modal">
    <form method="dialog" class="settings-form">
      <h2>Impostazioni</h2>
      <p>(Opzionale) In futuro qui potrai inserire chiavi API per funzioni avanzate.</p>
      <menu>
        <button id="save-settings" value="save" class="btn" type="button">Salva</button>
        <button id="close-settings" value="cancel" class="btn ghost" type="button">Chiudi</button>
        <button id="clear-settings" class="btn warn" type="button">Pulisci tutto</button>
      </menu>
    </form>
  </dialog>

  <footer class="app-footer">
    <small>Operazioni core offline. Le conversioni “lite” dei PDF sono state rimosse come richiesto.</small>
  </footer>

  <script src="script.js"></script>
</body>
</html>
